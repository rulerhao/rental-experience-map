# è‡ªå‹•åŒ–æ¸¬è©¦æŒ‡å—

é€™å€‹å°ˆæ¡ˆæä¾›äº†å¤šç¨®è‡ªå‹•åŒ–æ¸¬è©¦æ–¹æ¡ˆï¼Œè®“ä½ å¯ä»¥è¼•é¬†é©—è­‰ API çš„åŠŸèƒ½ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£æ¸¬è©¦ä¾è³´
```bash
npm install axios colors jest supertest nodemon --save-dev
```

### 2. å•Ÿå‹•ä¼ºæœå™¨
```bash
npm start
# æˆ–åœ¨èƒŒæ™¯åŸ·è¡Œ
npm run dev
```

### 3. åŸ·è¡Œæ¸¬è©¦
```bash
# åŸ·è¡ŒåŸºæœ¬è‡ªå‹•åŒ–æ¸¬è©¦
npm test

# åŸ·è¡Œ Jest æ¸¬è©¦å¥—ä»¶
npm run test:jest

# ç›£æ§æ¨¡å¼ï¼ˆæª”æ¡ˆè®Šæ›´æ™‚è‡ªå‹•é‡æ–°æ¸¬è©¦ï¼‰
npm run test:watch
```

## ğŸ“‹ æ¸¬è©¦æ–¹æ¡ˆ

### 1. Node.js è‡ªå‹•åŒ–æ¸¬è©¦ (`test-api.js`)

**ç‰¹è‰²ï¼š**
- å½©è‰²è¼¸å‡ºï¼Œæ˜“æ–¼é–±è®€
- å®Œæ•´çš„ CRUD æ¸¬è©¦
- è‡ªå‹•ç­‰å¾…ä¼ºæœå™¨å•Ÿå‹•
- è©³ç´°çš„æ¸¬è©¦çµæœæ‘˜è¦
- éŒ¯èª¤è™•ç†æ¸¬è©¦

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
node test-api.js
# æˆ–
npm test
```

**æ¸¬è©¦å…§å®¹ï¼š**
- âœ… ç²å–æ‰€æœ‰ç§Ÿå±‹è³‡æ–™
- âœ… ç²å–å–®ä¸€ç§Ÿå±‹è³‡æ–™
- âœ… å‰µå»ºæ–°ç§Ÿå±‹è³‡æ–™
- âœ… æ›´æ–°ç§Ÿå±‹è³‡æ–™
- âœ… åˆªé™¤ç§Ÿå±‹è³‡æ–™
- âœ… ç²å–è©•åˆ†è³‡æ–™
- âœ… æ–°å¢è©•åˆ†
- âœ… åœ°ç†ç·¨ç¢¼
- âœ… éŒ¯èª¤è™•ç†

### 2. Jest æ¸¬è©¦å¥—ä»¶ (`tests/api.test.js`)

**ç‰¹è‰²ï¼š**
- å°ˆæ¥­çš„æ¸¬è©¦æ¡†æ¶
- æ”¯æ´æ¸¬è©¦è¦†è“‹ç‡å ±å‘Š
- çµæ§‹åŒ–çš„æ¸¬è©¦çµ„ç¹”
- è©³ç´°çš„æ–·è¨€

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
npx jest
# æˆ–
npm run test:jest

# ç”Ÿæˆè¦†è“‹ç‡å ±å‘Š
npm run test:coverage
```

### 3. Postman é›†åˆ (`postman-collection.json`)

**ç‰¹è‰²ï¼š**
- è¦–è¦ºåŒ–æ¸¬è©¦ç•Œé¢
- å¯ä»¥æ‰‹å‹•æˆ–è‡ªå‹•åŸ·è¡Œ
- æ”¯æ´ç’°å¢ƒè®Šæ•¸
- å…§å»ºæ¸¬è©¦æ–·è¨€

**ä½¿ç”¨æ–¹æ³•ï¼š**

**åœ¨ Postman ä¸­ï¼š**
1. å°å…¥ `postman-collection.json`
2. è¨­ç½®ç’°å¢ƒè®Šæ•¸ `baseUrl = http://localhost:3000/api`
3. åŸ·è¡Œæ•´å€‹é›†åˆæˆ–å–®å€‹è«‹æ±‚

**ä½¿ç”¨ Newman (å‘½ä»¤åˆ—)ï¼š**
```bash
# å®‰è£ Newman
npm install -g newman

# åŸ·è¡Œæ¸¬è©¦
newman run postman-collection.json
```

### 4. PowerShell æ¸¬è©¦è…³æœ¬ (`test-runner.ps1`)

**ç‰¹è‰²ï¼š**
- ä¸€éµåŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
- è‡ªå‹•å•Ÿå‹•/åœæ­¢ä¼ºæœå™¨
- ç”Ÿæˆ HTML æ¸¬è©¦å ±å‘Š
- æ”¯æ´ä¸åŒæ¸¬è©¦é¡å‹

**ä½¿ç”¨æ–¹æ³•ï¼š**
```powershell
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ï¼ˆè‡ªå‹•å•Ÿå‹•å’Œåœæ­¢ä¼ºæœå™¨ï¼‰
.\test-runner.ps1 -TestType all -StartServer -StopServer

# åªåŸ·è¡Œ Node.js æ¸¬è©¦
.\test-runner.ps1 -TestType node

# åªåŸ·è¡Œ Jest æ¸¬è©¦
.\test-runner.ps1 -TestType jest

# åªåŸ·è¡Œ Postman æ¸¬è©¦
.\test-runner.ps1 -TestType postman
```

## ğŸ”§ æ¸¬è©¦é…ç½®

### Jest é…ç½® (`jest.config.js`)
```javascript
module.exports = {
  testEnvironment: 'node',
  testMatch: ['**/tests/**/*.test.js'],
  verbose: true,
  collectCoverage: true,
  coverageDirectory: 'coverage',
  testTimeout: 10000
};
```

### æ¸¬è©¦è¨­ç½® (`tests/setup.js`)
- è‡ªå‹•ç­‰å¾…ä¼ºæœå™¨å•Ÿå‹•
- å…¨åŸŸæ¸¬è©¦å‰å¾Œè™•ç†

## ğŸ“Š æ¸¬è©¦å ±å‘Š

### 1. æ§åˆ¶å°è¼¸å‡º
æ‰€æœ‰æ¸¬è©¦éƒ½æœƒåœ¨æ§åˆ¶å°é¡¯ç¤ºå½©è‰²çš„çµæœï¼š
- âœ… ç¶ è‰²è¡¨ç¤ºé€šé
- âŒ ç´…è‰²è¡¨ç¤ºå¤±æ•—
- â³ é»ƒè‰²è¡¨ç¤ºé€²è¡Œä¸­

### 2. Jest è¦†è“‹ç‡å ±å‘Š
```bash
npm run test:coverage
```
æœƒåœ¨ `coverage/` ç›®éŒ„ç”Ÿæˆ HTML å ±å‘Š

### 3. PowerShell HTML å ±å‘Š
ä½¿ç”¨ `test-runner.ps1` æœƒç”Ÿæˆæ™‚é–“æˆ³è¨˜çš„ HTML å ±å‘Š

## ğŸš¨ å¸¸è¦‹å•é¡Œ

### Q: æ¸¬è©¦å¤±æ•—ï¼Œé¡¯ç¤ºé€£æ¥éŒ¯èª¤
**A:** ç¢ºä¿ä¼ºæœå™¨æ­£åœ¨é‹è¡Œï¼š
```bash
npm start
# æª¢æŸ¥ä¼ºæœå™¨ç‹€æ…‹
netstat -an | findstr :3000
```

### Q: ä¸­æ–‡å­—ç¬¦é¡¯ç¤ºç‚ºå•è™Ÿ
**A:** é€™æ˜¯ PowerShell ç·¨ç¢¼å•é¡Œï¼Œä¸å½±éŸ¿ API åŠŸèƒ½ã€‚å¯ä»¥ï¼š
1. åœ¨ç€è¦½å™¨ä¸­æ¸¬è©¦
2. ä½¿ç”¨ Postman
3. è¨­ç½® PowerShell ç·¨ç¢¼ï¼š`chcp 65001`

### Q: Jest æ¸¬è©¦è¶…æ™‚
**A:** å¢åŠ è¶…æ™‚æ™‚é–“ï¼š
```javascript
// åœ¨æ¸¬è©¦æª”æ¡ˆä¸­
jest.setTimeout(15000);
```

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æ¸¬è©¦
**A:** 
1. **Node.js æ¸¬è©¦**ï¼šåœ¨ `test-api.js` ä¸­æ·»åŠ æ–°çš„æ¸¬è©¦æ–¹æ³•
2. **Jest æ¸¬è©¦**ï¼šåœ¨ `tests/` ç›®éŒ„å‰µå»ºæ–°çš„ `.test.js` æª”æ¡ˆ
3. **Postman æ¸¬è©¦**ï¼šåœ¨ Postman ä¸­ç·¨è¼¯é›†åˆä¸¦é‡æ–°å°å‡º

## ğŸ¯ æœ€ä½³å¯¦è¸

### 1. æ¸¬è©¦é †åº
å»ºè­°æŒ‰ä»¥ä¸‹é †åºåŸ·è¡Œæ¸¬è©¦ï¼š
1. åŸºæœ¬ CRUD æ“ä½œ
2. æ¥­å‹™é‚è¼¯æ¸¬è©¦
3. éŒ¯èª¤è™•ç†æ¸¬è©¦
4. æ€§èƒ½æ¸¬è©¦

### 2. æ¸¬è©¦è³‡æ–™ç®¡ç†
- ä½¿ç”¨æ¸¬è©¦å°ˆç”¨çš„è³‡æ–™
- æ¸¬è©¦å¾Œæ¸…ç†è³‡æ–™
- é¿å…ä¾è³´ç¾æœ‰è³‡æ–™

### 3. æŒçºŒæ•´åˆ
å¯ä»¥å°‡æ¸¬è©¦æ•´åˆåˆ° CI/CD æµç¨‹ï¼š
```yaml
# GitHub Actions ç¯„ä¾‹
- name: Run Tests
  run: |
    npm start &
    sleep 5
    npm test
```

### 4. æ¸¬è©¦è¦†è“‹ç‡
ç›®æ¨™é”åˆ° 80% ä»¥ä¸Šçš„æ¸¬è©¦è¦†è“‹ç‡ï¼š
```bash
npm run test:coverage
```

## ğŸ“ˆ é€²éšåŠŸèƒ½

### 1. æ€§èƒ½æ¸¬è©¦
å¯ä»¥æ·»åŠ éŸ¿æ‡‰æ™‚é–“æ¸¬è©¦ï¼š
```javascript
const startTime = Date.now();
const response = await axios.get('/api/rentals');
const responseTime = Date.now() - startTime;
expect(responseTime).toBeLessThan(1000); // 1ç§’å…§å›æ‡‰
```

### 2. è² è¼‰æ¸¬è©¦
ä½¿ç”¨å·¥å…·å¦‚ Artillery æˆ– k6 é€²è¡Œè² è¼‰æ¸¬è©¦

### 3. ç«¯åˆ°ç«¯æ¸¬è©¦
ä½¿ç”¨ Playwright æˆ– Cypress é€²è¡Œå‰ç«¯æ¸¬è©¦

## ğŸ”— ç›¸é—œè³‡æº

- [Jest å®˜æ–¹æ–‡æª”](https://jestjs.io/)
- [Supertest æ–‡æª”](https://github.com/visionmedia/supertest)
- [Postman æ–‡æª”](https://learning.postman.com/)
- [Newman æ–‡æª”](https://github.com/postmanlabs/newman)

---

**æç¤ºï¼š** å®šæœŸåŸ·è¡Œæ¸¬è©¦å¯ä»¥ç¢ºä¿ API çš„ç©©å®šæ€§å’Œå¯é æ€§ã€‚å»ºè­°åœ¨æ¯æ¬¡ç¨‹å¼ç¢¼è®Šæ›´å¾Œéƒ½åŸ·è¡Œå®Œæ•´çš„æ¸¬è©¦å¥—ä»¶ã€‚